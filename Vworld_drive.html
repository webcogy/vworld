<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>ì†Œë°©ì°¨ ë“±ë¡ ë° ì£¼í–‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
  <script type="text/javascript" src="https://map.vworld.kr/js/webglMapInit.js.do?version=2.0&apiKey=767B7ADF-10BA-3D86-AB7E-02816B5B92E9&domain=http://map.vworld.kr"></script>  
  <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script src="https://openlayers.org/en/v4.0.1/build/ol.js"></script>
    

</head>

<body>

    <div id="vmap" style="width:100%;height:90vh;left:0px;top:0px"></div>
    <input type="file" id="up_file" >  <input type="button" value ="ë°ì´í„°ë¡œë“œ" id="fileload" name="fileload" onclick="fileload();">
    <input type="button" onclick="measureLine()" value="ê±°ë¦¬">
    <input type="button" onclick="startDrive()" value="ì£¼í–‰ì‹œì‘">
    <input type="button" onclick="stopDrive()" value="ì£¼í–‰ì •ì§€">
    <input type="button" onclick="driveControl('speed',10)" value="ê°€ì†">
    <input type="button" onclick="driveControl('speed',-10)" value="ê°ì†">
    <div id="check" style="width:100%;height:100px;left:0px;top:0px; white-space: pre-line;"></div>


<script type="text/javascript">

var mapOptions = new vw.MapOptions(
    vw.BasemapType.GRAPHIC,
    "",
    vw.DensityType.FULL,
    vw.DensityType.BASIC,
    false,
    new vw.CameraPosition(
    new vw.CoordZ(127.425, 38.196, 13487),
    new vw.Direction(-90, 0, 0)
    ),
    new vw.CameraPosition(
    new vw.CoordZ(128.680000, 35.842834,200), // ì´ˆê¸°ìœ„ì¹˜ì¡°ì •
    new vw.Direction(0, -90, 0)
    )
);

var map = new vw.Map("vmap", mapOptions);

function fileload(){
    var tmppath = window.URL.createObjectURL($('[type=file]')[0].files[0]);
    var point = new vw.CoordZ(128.680000, 35.842834, 1);
    var options = { scale: 1000, minimumPixelSize: 10 };
    //var options = { minimumPixelSize: 200 };
    var id = "test1";

    var modelz = new vw.geom.ModelZ(id, tmppath, point, options );
    modelz.create();
    // ì´ë²¤íŠ¸ ì²˜ë¦¬ í•¨ìˆ˜ì´ë©°, íŒŒë¼ë¯¸í„°ë¡œ í´ë¦­ì‹œ window í”½ì…€, ecefì¢Œí‘œ, cartographicì¢Œí‘œ(ì‹¤ì œê²½ìœ„ë„), ê°ì²´ì •ë³´ë¥¼ ì¸ìˆ˜ë¡œ ë°›ëŠ”ë‹¤.
    var eventHandler = function(windowPosition, ecefPosition, cartographic, featureInfo) {      
        if ( featureInfo != null ) {
            // featureInfo ì™€ Pointê°ì²´ì™€ëŠ” ë‹¤ë¦„.
            // Point ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ê²½ìš° featureInfo.groupIdë¡œ ê°€ì ¸ì˜´.(ê·¸ë£¹ë³„ ì•„ì´ë””ë¼ê¸° ë³´ë‹¤ëŠ” ê°œë³„ì•„ì´ë””.)
            var id = featureInfo.groupId;
            var pointObj = map.getObjectById( id );
            // í…ìŠ¤íŠ¸ë¬¸êµ¬(HTML)
            var html = 'ì°¨ëŸ‰ ìš´í–‰ í…ŒìŠ¤íŠ¸';
            // ì œëª© title
            var title = "ì°¨ëŸ‰";
            // ì‹ë³„ì•„ì´ë””, íƒ‘ì¬ì»¨í…Œì´ë„ˆ, ì œëª©, html, ë ˆì´ì–´ê°€ë¡œê¸¸ì´, ë ˆì´ì–´ì„¸ë¡œê¸¸ì´, í´ë¦­ ì´ë²¤íŠ¸X, í´ë¦­ ì´ë²¤íŠ¸Y
            pop = new vw.Popup("pop01", "vmap", title, html, 450, 300, windowPosition.x, windowPosition.y);
            pop.create();
        }
    }
    modelz.addEventListener(eventHandler);
}



// ê±°ë¦¬ ì¸¡ì •
function measureLine() {
    if ( map != null ) {
        // static ë©”ì„œë“œë§Œ ìˆìŒ. start(), stop().
        vw.MeasureLine.start();
        // ìš°í´ë¦­ì‹œ ì¢…ë£Œ ì´ë²¤íŠ¸ ì„¤ì •
        var evtMeasureRightHandler = function(event) {
            vw.MeasureLine.stop();
        }
        vw.EventProcess.add( vw.MapController.RIGHTUPDNCLICK, map.onMouseRightDown, evtMeasureRightHandler);
    }
    console.log("ğŸš€ ~ file: Vworld_drive.html ~ line 92 ~ measureLine ~ vw.Coord", vw.Coord)
}
/* 
var drive;
function startDrive()
{
    if(drive == null) drive = new vw.cameraAction.Drive();
    drive.start();
}

function stopDrive()
{
    if(drive != null) drive.stop();
}

function driveControl(flag, val){
    switch(flag){
    case 'speed' :
        val = drive.getSpeed() + val;
        drive.setSpeed(val);
        break;
    case 'heading' :
        drive.setHeadingSpeed(val);
        break;
    }
}


// ì¢Œí‘œë¡œ ì´ë™
function vwmoveTo(x,y,z){
    var movePo = new vw.CoordZ(x,y,z);
    var mPosi = new vw.CameraPosition(movePo, new vw.Direction(0,-80,0));
    map.moveTo(mPosi);     
}
 */
</script>
</body>
</html>  